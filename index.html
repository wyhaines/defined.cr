<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Crystal Docs 1.9.2">
<meta name="crystal_docs.project_version" content="0.3.6">
<meta name="crystal_docs.project_name" content="defined">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="defined">
  <title>defined 0.3.6</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill="currentColor" fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<input type="checkbox" id="sidebar-btn">
<label for="sidebar-btn" id="sidebar-btn-label">
  <svg class="open" xmlns="http://www.w3.org/2000/svg" height="2em" width="2em" viewBox="0 0 512 512"><title>Open Sidebar</title><path fill="currentColor" d="M80 96v64h352V96H80zm0 112v64h352v-64H80zm0 112v64h352v-64H80z"></path></svg>
  <svg class="close" xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 512 512"><title>Close Sidebar</title><path fill="currentColor" d="m118.6 73.4-45.2 45.2L210.7 256 73.4 393.4l45.2 45.2L256 301.3l137.4 137.3 45.2-45.2L301.3 256l137.3-137.4-45.2-45.2L256 210.7Z"></path></svg>
</label>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          defined
        </a>
      </h1>

      <span class="project-version">
        0.3.6
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class=" " data-id="defined/toplevel" data-name="top level namespace">
      <a href="toplevel.html">Top Level Namespace</a>
      
    </li>
  
  <li class=" " data-id="defined/Defined" data-name="defined">
      <a href="Defined.html">Defined</a>
      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<p><a href="https://github.com/wyhaines/defined.cr/actions/workflows/ci.yml"><img src="https://github.com/wyhaines/defined.cr/actions/workflows/ci.yml/badge.svg" alt="Defined.cr CI" /></a>
<a href="https://github.com/wyhaines/defined.cr/actions/workflows/ci.yml"><img src="https://github.com/wyhaines/defined.cr/actions/workflows/ci.yml/badge.svg" alt="Defined.cr CI" /></a></p>
<p><a href="https://github.com/wyhaines/defined.cr/releases"><img src="https://img.shields.io/github/release/wyhaines/defined.cr.svg?style=for-the-badge" alt="GitHub release" /></a>
<img src="https://img.shields.io/github/commits-since/wyhaines/defined.cr/latest?style=for-the-badge" alt="GitHub commits since latest release (by SemVer)" /></p>
<h1><a id="defined.cr" class="anchor" href="#defined.cr">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>defined.cr</h1>
<p>This shard provides a variety of macros that can be used to check, at compile time, if a
given constant is defined, and also to conditionally compile code based on whether a
constant is or is not defined, whether a VERSION meets a requirement, or whether an
environment variable is or is not defined.</p>
<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>
<ol>
<li>
<p>Add the dependency to your <code>shard.yml</code>:</p>
<pre><code class="language-yaml">dependencies:
  defined:
    github: wyhaines/defined.cr</code></pre>
</li>
<li>
<p>Run <code>shards install</code></p>
</li>
</ol>
<h2><a id="usage" class="anchor" href="#usage">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Usage</h2>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;defined&quot;</span></code></pre>
<h3><a id="constant-check-macro-notes" class="anchor" href="#constant-check-macro-notes">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Constant Check Macro Notes</h3>
<p>The constant check that of of the constant validation macros (<code><a href="toplevel.html#defined%3F%28const%29-macro">defined?</a></code>, <code><a href="toplevel.html#if_defined%3F%28const%2C%26code%29-macro">if_defined?</a></code>, <code><a href="toplevel.html#unless_defined%3F%28const%2C%26code%29-macro">unless_defined?</a></code>) use first checks for the constant relative to the type that the macro is
running in, and then if it doesn't find it there, it checks starting at the top level, with
one exception. If the class name starts with a <code>::</code> then the check only operates from the
top level. The class name can be provided as a String, a Symbol, or as a bare Class reference.</p>
<p>i.e.</p>
<pre><code class="language-crystal">if_defined?(<span class="s">&quot;Int32&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will always work&quot;</span>
<span class="k">end</span>

unless_defined?(<span class="t">ClassName</span><span class="t">::</span><span class="t">That</span><span class="t">::</span><span class="t">Does</span><span class="t">::</span><span class="t">Not</span><span class="t">::</span><span class="t">Exist</span>) <span class="k">do</span>
  puts <span class="s">&quot;This works, too. Cool.&quot;</span>
<span class="k">end</span></code></pre>
<h4><a id="defined" class="anchor" href="#defined">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>defined?</h4>
<pre><code class="language-crystal"><span class="k">if</span> defined?(<span class="t">OptionalFeature</span>)
  <span class="c"># The OptionalFeature library has been included into the code, so use it.</span>
<span class="k">else</span>
  <span class="c"># It&#39;s not there.</span>
<span class="k">end</span>

stuff <span class="o">=</span> defined?(<span class="t">My</span><span class="t">::</span><span class="t">Stuff</span><span class="t">::</span><span class="t">Library</span>) <span class="o">||</span> <span class="t">Array</span>(<span class="t">String</span>)</code></pre>
<h4><a id="if-defined" class="anchor" href="#if-defined">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>if_defined?</h4>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;defined&quot;</span>

<span class="k">class</span> <span class="t">One</span>; <span class="k">end</span>

if_defined?(<span class="t">One</span>) <span class="k">do</span>
  <span class="k">class</span> <span class="t">Two</span>
    <span class="k">def</span> <span class="m">call</span>
      <span class="s">&quot;I am class Two, but I can only exist of class one is defined.&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

puts <span class="t">Two</span>.new.call</code></pre>
<h4><a id="unless-defined" class="anchor" href="#unless-defined">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>unless_defined?</h4>
<pre><code class="language-crystal">unless_defined?(<span class="t">PerfectShard</span>) <span class="k">do</span>
  <span class="k">require</span> <span class="s">&quot;project/imperfect_shard&quot;</span>
<span class="k">end</span></code></pre>
<h3><a id="version-checks" class="anchor" href="#version-checks">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Version Checks</h3>
<p>The version check macros leverage the same constant lookup code as the constant check macros, but they automatically search for a <code>VERSION</code> or a <code>Version</code> constant under that namespace, unless the provided constant resolves to a <code>String</code>.</p>
<h4><a id="if-version-and-unless-version" class="anchor" href="#if-version-and-unless-version">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>if_version? and unless_version?</h4>
<pre><code class="language-crystal"><span class="k">class</span> <span class="t">VerMe</span>
  <span class="t">VERSION</span> <span class="o">=</span> <span class="s">&quot;1.2.3&quot;</span>

  <span class="k">class</span> <span class="t">Inner</span>
    <span class="t">Version</span> <span class="o">=</span> <span class="s">&quot;0.1.0&quot;</span>
  <span class="k">end</span>

  <span class="k">class</span> <span class="t">SecondInner</span>
    <span class="t">ClassVersion</span> <span class="o">=</span> <span class="s">&quot;0.3.7&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>

if_version?(<span class="t">VerMe</span>, <span class="n">:&gt;=</span>, <span class="s">&quot;1.2.0&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will only run if the version of VerMe is &gt;= 1.2.0&quot;</span>
<span class="k">end</span>

if_version?(<span class="t">VerMe</span><span class="t">::</span><span class="t">Inner</span>, <span class="n">:&gt;=</span>, <span class="s">&quot;0.1.0&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will only run if the version of VerMe::Inner is &gt;= 0.1.0&quot;</span>
<span class="k">end</span>

unless_version?(<span class="t">VerMe</span><span class="t">::</span><span class="t">SecondInner</span><span class="t">::</span><span class="t">ClassVersion</span>, <span class="n">:&gt;=</span>, <span class="s">&quot;0.4.0&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This also works. Hey, maybe you need a new version of that class?&quot;</span>
<span class="k">end</span>

<span class="k">class</span> <span class="t">VerMe</span>
  if_version?(<span class="t">Inner</span>, <span class="n">:&lt;</span>, <span class="s">&quot;0.2.0&quot;</span>) <span class="k">do</span>
    puts <span class="s">&quot;WARNING -- Using version of Inner less than 0.2.0 is deprecated, and support will be removed&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="t">MacrosAreTough</span>
  <span class="t">VERSION</span> <span class="o">=</span> <span class="o">{{</span> <span class="s">`shards version &quot;</span><span class="i">#{</span>__DIR__<span class="i">}</span><span class="s">&quot;`</span>.chomp.stringify }}
<span class="k">end</span>

if_version?(<span class="t">MacrosAreTough</span>, <span class="n">:&gt;=</span>, <span class="s">&quot;0.1.0&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will only run if the version of MacrosAreTough is &gt;= 0.1.0&quot;</span>
<span class="k">end</span></code></pre>
<p>The last example, with <code>MacrosAreTough</code>, <a href="https://wyhaines.github.io/defined.cr/toplevel.html#if_version?(const,comparison,value,&amp;code)-macro">deserves additional explanation</a>, because inline macro expressions
like that pose a particular challenge for the library, and there are some edge cases.</p>
<h3><a id="environment-variable-checks" class="anchor" href="#environment-variable-checks">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Environment Variable Checks</h3>
<p>This facility provides four very simple macros (<code><a href="toplevel.html#if_enabled%3F%28env_var%2C%26block%29-macro">if_enabled?</a></code>, <code><a href="toplevel.html#unless_enabled%3F%28env_var%2C%26block%29-macro">unless_enabled?</a></code>, <code><a href="toplevel.html#if_disabled%3F%28env_var%2C%26block%29-macro">if_disabled?</a></code>, <code><a href="toplevel.html#unless_disabled%3F%28env_var%2C%26block%29-macro">unless_disabled?</a></code>) which can be used to conditionally compile code based on whether an environment variable is set, or not. The macros use a shell based definition of truthy and falsey, so <code>0</code> and <code>false</code> and <code>&quot;&quot;</code> are considered false, while all other values are true.</p>
<p><code><a href="toplevel.html#if_enabled%3F%28env_var%2C%26block%29-macro">if_enabled?</a></code> instantiates the code in the provided block if the environment variable exists, and is set to
a shell truthy value.</p>
<p><code><a href="toplevel.html#unless_enabled%3F%28env_var%2C%26block%29-macro">unless_enabled?</a></code> instantiates the code in the provided block if the environment variable does not exist, or is set to a shell falsey value.</p>
<p><code><a href="toplevel.html#if_disabled%3F%28env_var%2C%26block%29-macro">if_disabled?</a></code> instantiates the code in the provided block if the environment variable des not exist, or is set to a shell falsey value.</p>
<p><code><a href="toplevel.html#unless_disabled%3F%28env_var%2C%26block%29-macro">unless_disabled?</a></code> instantiates the code in the provided block if the environment variable exists, and is set to a shell truthy value.</p>
<pre><code class="language-crystal">if_enabled?(<span class="s">&quot;ENV_VAR&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will only run if the environment variable ENV_VAR is set to a truthy value&quot;</span>
<span class="k">end</span>

unless_enabled?(<span class="s">&quot;ENV_VAR&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will only run if the environment variable ENV_VAR is not set to a truthy value&quot;</span>
<span class="k">end</span>

if_disabled?(<span class="s">&quot;ENV_VAR&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will only run if the environment variable ENV_VAR is not set to a truthy value&quot;</span>
<span class="k">end</span>

unless_disabled?(<span class="s">&quot;ENV_VAR&quot;</span>) <span class="k">do</span>
  puts <span class="s">&quot;This will only run if the environment variable ENV_VAR is set to a truthy value&quot;</span>
<span class="k">end</span></code></pre>
<h2><a id="more-documentation" class="anchor" href="#more-documentation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>More Documentation</h2>
<p><a href="https://wyhaines.github.io/defined.cr/toplevel.html">https://wyhaines.github.io/defined.cr/toplevel.html</a></p>
<h2><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h2>
<ol>
<li>Fork it (<a href="https://github.com/wyhaines/defined.cr/fork">https://github.com/wyhaines/defined.cr/fork</a>)</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>
<ul>
<li><a href="https://github.com/wyhaines">Kirk Haines</a> - creator and maintainer</li>
</ul>
<p><img src="https://img.shields.io/github/languages/code-size/wyhaines/defined.cr?style=for-the-badge" alt="GitHub code size in bytes" />
<img src="https://img.shields.io/github/issues/wyhaines/defined.cr?style=for-the-badge" alt="GitHub issues" /></p>
</div>
</body>
</html>
